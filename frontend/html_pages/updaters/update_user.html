<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
    >
</head>
<body>
<button id="unlogin">Unlogin</button>

<div class="container mt-5">
    <div class="row g-3 my-1">
        <h4 class="col-2 text-center"><strong>user ID</strong></h4>
        <input type="number" class="col-2" id="update_user_id">
    </div>
    <div class="row g-3 my-1">
        <h4 class="col-2 text-center">New role</h4>
        <input type="text" class="col-2" id="update_user_role">
    </div>

    <div class="row g-3 my-1">
        <div class="col-2 text-end">
        </div>
        <button title="Будьте внимательны при изменении роли!" id="update user" class="col-2">UPDATE user</button>
    </div>
</div>

<div class="container py-5">
    <div class="row g-3">
        <div class="col-md-4">
            <div class="card-custom p-3 h-100">
                <form id="form_for_deleting_user" class="d-flex gap-2 align-items-center">
                    <input id="user_id" type="number" class="form-control" placeholder="user ID">
                    <button class="btn btn-danger" id="delete_user_by_id_button">Delete user account</button>
                </form>
            </div>
        </div>
    </div>
</div>



<script type="module">
    import {json_fetch} from "../../html_scripts/funcs.js";
    document.getElementById("update user").addEventListener('click', event => {
        let user_id_el = document.getElementById("update_user_id")
        let user_id = user_id_el.value
        let new_role_el = document.getElementById("update_user_role")
        let new_role = new_role_el.value
        json_fetch(`http://localhost:8000/role_setter/${user_id}`, {method: "PATCH", credentials: "include", body: JSON.stringify({"role_to_change": new_role})}).then(response => {
            console.log(response)

    })
        user_id_el.value = ''
        new_role_el.value = ''
    })
    document.getElementById("form_for_deleting_user").addEventListener('submit', event => {
        event.preventDefault()
        let user_id_el = document.getElementById("user_id")
        json_fetch(`http://localhost:8000/delete_account/${user_id_el.value}`, {method: "DELETE",credentials: "include"}).then(response => {
            console.log(response)
        })
    })

    import {includeUnlogin} from "../../html_scripts/funcs.js";
    includeUnlogin()

</script>

</body>
</html>